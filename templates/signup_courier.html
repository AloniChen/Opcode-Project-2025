<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DeliverySim • Create Courier Account</title>
  <style>
    :root{ --bg:#484849; --card:#ffffff; --text:#1f2937; --muted:#6b7280; --primary:#F6BD1A; --ring:0 0 0 4px rgba(246,189,26,.25); --radius:18px; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;color:var(--text);background:var(--bg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
    .wrapper{min-height:100%;display:grid;place-items:center;padding:24px}
    .card{width:min(960px,100%);background:var(--card);border-radius:var(--radius);box-shadow:0 30px 60px rgba(0,0,0,.35);overflow:hidden;display:grid;grid-template-columns:1.15fr .85fr}
    @media (max-width:920px){.card{grid-template-columns:1fr}}
    .form-side{padding:clamp(20px,5vw,40px)}
    .badge{display:inline-flex;align-items:center;gap:10px;margin:0 auto 10px;background:var(--primary);color:#1f2937;font-weight:800;letter-spacing:.2px;padding:8px 14px;border-radius:999px;box-shadow:0 6px 20px rgba(246,189,26,.35)}
    .badge svg{width:18px;height:18px}
    h1.title{margin:6px 0 6px;font-size:clamp(24px,3.2vw,34px);line-height:1.1;font-weight:900}
    p.muted{margin:0 0 16px;color:var(--muted)}
    .form{display:grid;gap:14px}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(2,minmax(0,1fr))}
    .span-2{grid-column:span 2}
    @media (max-width:680px){.grid{grid-template-columns:1fr}.span-2{grid-column:auto}}
    .field{display:flex;flex-direction:column;gap:6px}
    .label{font-size:.92rem;font-weight:700;color:#374151}
    .input,.select,.textarea{appearance:none;height:46px;border-radius:12px;border:1px solid #e5e7eb;background:#fff;outline:0;padding:0 12px;font-size:15px;transition:box-shadow .15s ease,border-color .15s ease,background-color .2s ease}
    .textarea{min-height:90px;padding:10px 12px;resize:vertical}
    .input:focus,.select:focus,.textarea:focus{border-color:var(--primary);box-shadow:var(--ring)}
    .hint{font-size:.85rem;color:#9ca3af}
    .pw-wrap{position:relative}
    .pw-toggle{position:absolute;right:10px;top:50%;transform:translateY(-50%);border:0;background:transparent;cursor:pointer;padding:6px}
    .meter{height:8px;border-radius:999px;background:#f3f4f6;overflow:hidden}
    .meter>span{display:block;height:100%;width:0%;background:linear-gradient(90deg,#ef4444,#f59e0b,#22c55e);transition:width .25s ease}
    .fieldset{border:1px solid #eef0f2;border-radius:14px;padding:14px}
    .legend{font-weight:800;color:#374151;padding:0 6px}
    .actions{display:grid;gap:10px;margin-top:6px}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;height:48px;border-radius:12px;border:1px solid transparent;font-weight:800;cursor:pointer;user-select:none;transition:transform .05s ease,filter .15s ease,box-shadow .15s ease}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--primary);color:#1f2937;box-shadow:0 10px 18px rgba(246,189,26,.35)}
    .btn-primary:hover{filter:brightness(.98)}
    .btn-ghost{background:#fff;border-color:#e5e7eb}
    .note{text-align:center;color:var(--muted);font-size:.95rem}
    .note a{color:var(--primary);font-weight:800;text-decoration:none}
    .toast{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);background:#111827;color:#e5e7eb;padding:10px 14px;border-radius:12px;display:none}
    .showcase{position:relative;background:transparent;display:grid;align-content:center;justify-items:center;padding:clamp(20px,5vw,40px)}
    .phone{width:min(330px,70vw);aspect-ratio:9/19.5;border-radius:34px;background:#0f172a;box-shadow:0 20px 60px rgba(0,0,0,.45);padding:14px;position:relative}
    .notch{width:50%;height:18px;background:#111827;border-bottom-left-radius:12px;border-bottom-right-radius:12px;position:absolute;left:50%;transform:translateX(-50%);top:0}
    .screen{width:100%;height:100%;border-radius:20px;background:#111827;padding:16px;display:grid;gap:12px;color:#e5e7eb}
    .pill{height:36px;border-radius:999px;display:flex;align-items:center;padding:0 12px;background:rgba(255,255,255,.08);gap:10px}
    .pill .dot{width:10px;height:10px;border-radius:999px;background:var(--primary);box-shadow:0 0 0 4px rgba(246,189,26,.18)}
    .order{background:#111827;border-radius:14px;padding:12px;display:grid;gap:8px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.05)}
    .order .row{display:flex;align-items:center;justify-content:space-between}
    .tag{padding:4px 10px;border-radius:999px;background:rgba(246,189,26,.18);color:#fde68a;font-weight:700;font-size:.8rem}
    footer.small{text-align:center;color:#9ca3af;font-size:.8rem;margin-top:16px}
    .warning{display:none;margin:8px 0 0;background:#fff3cd;border:1px solid #ffe69c;color:#8a6d3b;padding:10px 12px;border-radius:10px}
    .errors{margin:8px 0 0;background:#fee2e2;border:1px solid #fecaca;color:#7f1d1d;padding:10px 12px;border-radius:10px;display:none}
    .errors ul{margin:0;padding-left:18px}
  </style>
</head>
<body>
  <main class="wrapper">
    <section class="card" role="region" aria-labelledby="title">
      <div class="form-side">
        <div class="badge" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="M3 7.5 12 3l9 4.5-9 4.5L3 7.5Z" fill="#1f2937" opacity=".15"/><path d="M3 7.5 12 12l9-4.5M3 7.5V16.5L12 21l9-4.5V7.5M12 12V21" stroke="#1f2937" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
          DeliverySim
        </div>
        <h1 id="title" class="title">Create courier account</h1>
        <p class="muted">Fill in your details. We’ll verify your license and vehicle info.</p>

        <div id="userTypeWarn" class="warning">URL user_type was not <code>courier</code>. Proceeding as courier.</div>
        <div id="clientErrors" class="errors" aria-live="polite"><ul></ul></div>

        <form class="form" method="post" action="{{ url_for('signup', user_type='couriers') }}">
          <label class="field">
            <span class="label">Courier ID</span>
            <input class="input" name="courier_id" inputmode="numeric" pattern="\d*" required placeholder="e.g., 100000101" />
          </label>
          <input type="hidden" name="user_type" id="userTypeHidden" value="courier" />

          <fieldset class="fieldset"><legend class="legend">Personal</legend>
            <div class="grid">
              <label class="field"><span class="label">Full name</span>
                <input class="input" name="full_name" required minlength="2" maxlength="80" placeholder="e.g., Dana Levi" />
              </label>
              <label class="field"><span class="label">Phone</span>
                <input class="input" name="phone" required inputmode="tel" placeholder="+972-50-1234567" pattern="^\+?[0-9\-\s]{9,15}$" />
                <span class="hint">Digits, spaces, dashes allowed.</span>
              </label>
              <label class="field"><span class="label">Email</span>
                <input class="input" name="email" type="email" required placeholder="name@example.com" />
              </label>
              <label class="field pw-wrap"><span class="label">Password</span>
                <input class="input" id="pw" name="password" type="password" minlength="6" required placeholder="At least 6 characters" />
                <button class="pw-toggle" type="button" aria-label="Show password" title="Show/Hide" id="pwToggle">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#6b7280" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7Z"/><circle cx="12" cy="12" r="3"/></svg>
                </button>
              </label>
            </div>
            <div class="meter" aria-hidden="true"><span id="pwMeter"></span></div>
            <div class="hint" id="pwHint">Password strength</div>
          </fieldset>

          <fieldset class="fieldset"><legend class="legend">Home base (optional)</legend>
            <div class="grid">
              <label class="field"><span class="label">City</span><input class="input" name="city" /></label>
              <label class="field"><span class="label">Street</span><input class="input" name="street" /></label>
              <label class="field"><span class="label">House number</span><input class="input" name="house_number" pattern="^\d{1,4}$" /></label>
              <label class="field"><span class="label">Postal code</span><input class="input" name="postal_code" pattern="^\d{5,7}$" /></label>
              <label class="field span-2"><span class="label">Notes</span><input class="input" name="notes" placeholder="Gate 1234#, buzzer, etc." /></label>
            </div>
          </fieldset>

          <fieldset class="fieldset"><legend class="legend">Courier details</legend>
            <div class="grid">
              <label class="field"><span class="label">Vehicle type</span>
                <select class="select" name="vehicle_type" required>
                  <option value="">Select…</option>
                  <option>Bike</option><option>Scooter</option><option>Motorcycle</option><option>Car</option><option>Van</option>
                </select>
              </label>
              <label class="field"><span class="label">License plate</span>
                <input class="input" name="license_plate" required placeholder="12-345-67" pattern="^\d{2}-\d{3}-\d{2}$" />
                <span class="hint">Format: 12-345-67</span>
              </label>
              <label class="field"><span class="label">Driver license #</span>
                <input class="input" name="driver_license" required placeholder="XXXXXXXXX" pattern="^\d{7,9}$" />
              </label>
              <label class="field"><span class="label">License expiry</span>
                <input class="input" type="date" name="license_expiry" required />
              </label>
              <label class="field"><span class="label">Service area</span><input class="input" name="service_area" /></label>
              <label class="field"><span class="label">Availability</span>
                <select class="select" name="availability" required>
                  <option value="">Select…</option>
                  <option>Full-time</option><option>Part-time</option><option>Weekends only</option>
                </select>
              </label>
              <label class="field span-2"><span class="label">Equipment (optional)</span><input class="input" name="equipment" placeholder="Thermal bag, phone mount, etc." /></label>
            </div>
          </fieldset>

          <fieldset class="fieldset"><legend class="legend">Payout info</legend>
            <div class="grid">
              <label class="field"><span class="label">Account holder</span><input class="input" name="acct_holder" required /></label>
              <label class="field"><span class="label">Bank name</span><input class="input" name="bank_name" required /></label>
              <label class="field"><span class="label">Branch / Code</span><input class="input" name="branch_code" required pattern="^\d{1,4}$" /></label>
              <label class="field"><span class="label">Account number</span><input class="input" name="account_number" required pattern="^\d{5,12}$" /></label>
            </div>
            <div class="hint">Payments are encrypted in transit.</div>
          </fieldset>

          <label style="display:flex;align-items:center;gap:10px"><input type="checkbox" name="agree" required/> I agree to the Terms and Privacy Policy</label>

          <div class="actions">
            <button class="btn btn-primary" type="submit">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#1f2937" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
              Create Courier Account
            </button>
            <button class="btn btn-ghost" type="button" id="demoFill">Fill demo data</button>
            <div class="note">Need a customer account? <a href="/signup?user_type=customer">Sign up here</a></div>
          </div>
        </form>
        <footer class="small">We’ll verify your documents after submission.</footer>
      </div>

      <div class="showcase" aria-hidden="true">
        <div class="phone"><div class="notch"></div><div class="screen">
          <div class="pill"><span class="dot"></span> Courier mode active</div>
          <div class="order"><div class="row"><strong>Pickup</strong><span class="tag">New</span></div><div class="row"><span>Warehouse • Jabotinsky 12</span><span>ETA 10m</span></div></div>
          <div class="order"><div class="row"><strong>Dropoff</strong><span class="tag">Priority</span></div><div class="row"><span>Herzl 90</span><span>13:05</span></div></div>
          <div class="pill"><span class="dot"></span> Payout every Thursday</div>
        </div></div>
        <footer class="small">Fast • Reliable • Delightful</footer>
      </div>
    </section>
  </main>

  <div id="toast" class="toast" role="status" aria-live="polite">Courier account created (demo)</div>

  <script>
    // --- URL param enforcement ---
    const params = new URLSearchParams(location.search);
    const ut = (params.get('user_type')||'courier').toLowerCase();
    const warn = document.getElementById('userTypeWarn');
    const hidden = document.getElementById('userTypeHidden');
    if(ut !== 'courier'){ warn.style.display='block'; hidden.value='courier'; }

    // --- Password meter + toggle ---
    const pw = document.getElementById('pw');
    const bar = document.getElementById('pwMeter');
    const hint = document.getElementById('pwHint');
    const toggle = document.getElementById('pwToggle');
    function strength(v){ let s=0; if(v.length>=6)s++; if(/[A-Z]/.test(v))s++; if(/[a-z]/.test(v))s++; if(/\d/.test(v))s++; if(/[^\w]/.test(v))s++; return Math.min(s,5); }
    function render(){ const s=strength(pw.value); const pct=[0,20,40,65,85,100][s]; bar.style.width=pct+'%'; const labels=['Too short','Weak','Okay','Good','Strong','Excellent']; hint.textContent='Password strength: '+labels[s]; }
    pw.addEventListener('input', render); render();
    toggle.addEventListener('click', ()=>{ pw.type = pw.type==='password' ? 'text' : 'password'; });

    // --- Client-side validation ---
    const form = document.getElementById('courierForm');
    const errBox = document.getElementById('clientErrors');
    function setMinDateToday(){
      const d = new Date();
      const yyyy=d.getFullYear();
      const mm=String(d.getMonth()+1).padStart(2,'0');
      const dd=String(d.getDate()).padStart(2,'0');
      document.querySelector('input[name="license_expiry"]').setAttribute('min', `${yyyy}-${mm}-${dd}`);
    }
    setMinDateToday();

    // Custom messages for specific fields
    const messages = {
      phone: 'Phone must be 9–15 digits (spaces/dashes allowed).',
      license_plate: 'License plate must match format 12-345-67.',
      driver_license: 'Driver license should be 7–9 digits.',
      branch_code: 'Branch code must be 1–4 digits.',
      account_number: 'Account number must be 5–12 digits.',
    };

    form.addEventListener('submit', (e)=>{
      errBox.style.display='none';
      errBox.querySelector('ul').innerHTML='';

      // built-in validity
      if(!form.checkValidity()){
        e.preventDefault();
        const invalid = form.querySelectorAll(':invalid');
        invalid.forEach(el=>{
          const name = el.getAttribute('name');
          const label = el.closest('.field')?.querySelector('.label')?.textContent || name;
          const msg = messages[name] || el.validationMessage;
          const li = document.createElement('li');
          li.textContent = `${label}: ${msg}`;
          errBox.querySelector('ul').appendChild(li);
        });
        errBox.style.display='block';
        invalid[0]?.focus();
      }
    });

    // Demo fill
    document.getElementById('demoFill').addEventListener('click', ()=>{
      const f=form.elements;
      f.full_name.value='Avi Cohen';
      f.phone.value='+972-52-234-5678';
      f.email.value='avi@example.com';
      f.password.value='Avi123!'; render();
      f.city.value='Tel Aviv'; f.street.value='Herzl'; f.house_number.value='12'; f.postal_code.value='6100000';
      f.vehicle_type.value='Scooter'; f.license_plate.value='12-345-67'; f.driver_license.value='987654321';
      const nextYear = new Date().getFullYear()+1; f.license_expiry.value=`${nextYear}-06-30`;
      f.service_area.value='Gush Dan'; f.availability.value='Full-time'; f.equipment.value='Thermal bag, phone mount';
      f.acct_holder.value='Avi Cohen'; f.bank_name.value='Bank Hapoalim'; f.branch_code.value='123'; f.account_number.value='000123456';
      f.agree.checked=true;
    });
  </script>
</body>
</html>